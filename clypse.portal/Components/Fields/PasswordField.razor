@using clypse.core.Password
@using clypse.core.Enums

<div class="mb-3">
    <label class="form-label">@Label</label>
    <div class="input-group">
        <input type="@(showPassword ? "text" : "password")" 
               class="form-control" 
               @bind="Value" 
               @bind:after="OnPasswordChanged"
               @oninput="OnPasswordInput"
               placeholder="@Placeholder"
               readonly="@IsReadOnly" />
        
        @if (!IsReadOnly || ShowRevealButton)
        {
            <button class="btn btn-secondary" type="button" @onclick="TogglePasswordVisibility">
                <i class="bi bi-@(showPassword ? "eye-slash" : "eye")"></i>
            </button>
        }
        
        @if (!IsReadOnly && ShowGeneratorButton)
        {
            <button class="btn btn-success" type="button" @onclick="ShowPasswordGenerator" title="Generate Password">
                <i class="bi bi-calculator"></i>
            </button>
        }
    </div>
    
    @* Password Strength Indicator *@
    @if (!string.IsNullOrEmpty(Value) && ShowStrengthIndicator)
    {
        <div class="mt-2">
            <div class="d-flex justify-content-between align-items-center mb-1">
                <small class="text-muted">Password Strength</small>
                <small class="@GetComplexityColorClass() fw-bold">@GetComplexityText()</small>
            </div>
            <div class="progress" style="height: 6px;">
                <div class="progress-bar @GetComplexityBackgroundColorClass()" 
                     role="progressbar" 
                     style="width: @GetComplexityPercentage()%"
                     aria-valuenow="@GetComplexityPercentage()" 
                     aria-valuemin="0" 
                     aria-valuemax="100">
                </div>
            </div>
            @if (!string.IsNullOrEmpty(passwordComplexityResults?.AdditionalInfo))
            {
                <small class="text-muted d-block mt-1">@passwordComplexityResults.AdditionalInfo</small>
            }
        </div>
    }
</div>

<PasswordGeneratorDialog 
    Show="showPasswordGenerator" 
    OnPasswordGenerated="HandlePasswordGenerated" 
    OnCancel="HandlePasswordGeneratorCancel" />